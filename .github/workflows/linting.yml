name: lint

on:
    push:
        branches:
        - main
        - develop
        - ci
        - feature/*
    pull_request:
        branches:
        - main

jobs:
    fmt:
        runs-on: ubuntu-latest
        steps:
        - uses: actions/checkout@v4
        - name: Setup Rust
          uses: actions-rust-lang/setup-rust-toolchain@v1.8.0
          with:
            toolchain: nightly
            components: rustfmt
        - name: Run rustfmt
          run: cargo fmt --all -- --check
    
    clippy:
        runs-on: ubuntu-latest
        steps:
        - uses: actions/checkout@v4
        - name: Setup Rust
          uses: actions-rust-lang/setup-rust-toolchain@v1.8.0
          with:
            toolchain: nightly
            components: clippy
        - name: Run clippy
          uses: giraffate/clippy-action@v1.0.1
          with:
            reporter: github-pr-review
            github_token: ${{ secrets.GITHUB_TOKEN }}
            clippy_flags: --workspace --tests --all-features
          

